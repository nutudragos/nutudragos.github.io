<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Resolution summary [!summary]
Enumerated with [[Nmap]] finding FTP, SSH, SMB, and distccd services vsftpd 2.3.4 on port 21 appeared vulnerable but was a decoy (port 6200 filtered) SMB anonymous login successful but no useful access Exploited distccd v1 on port 3632 (CVE-2004-2687) for initial shell as daemon Enumerated with LinPEAS finding SUID binaries Escalated privileges using nmap interactive mode to root Improved skills Identifying decoy services distccd exploitation SUID binary privilege escalation GTFOBins usage for privilege escalation Used tools [[Nmap]] LinPEAS Python POC for distccd RCE Information Gathering Scanned all TCP ports:
" />
<meta name="keywords" content="homepage, blog, cyber, cyberblog, cybersecurity, distccd, samba, nmap-privesc" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/lame/" />


    <title>
        
             :: Dragos Nutu 
        
    </title>





  <link rel="stylesheet" href="../../main.min.2729760c629597024c5de34b40ea9f372f2b5a2a192dcdca537b7ddfa483eab8.css" integrity="sha256-Jyl2DGKVlwJMXeNLQOqfNy8rWioZLc3KU3t936SD6rg=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
    <link rel="manifest" href="../../site.webmanifest">
    <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="../../favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Dragos Nutu">
  <meta itemprop="description" content="Resolution summary [!summary]
Enumerated with [[Nmap]] finding FTP, SSH, SMB, and distccd services vsftpd 2.3.4 on port 21 appeared vulnerable but was a decoy (port 6200 filtered) SMB anonymous login successful but no useful access Exploited distccd v1 on port 3632 (CVE-2004-2687) for initial shell as daemon Enumerated with LinPEAS finding SUID binaries Escalated privileges using nmap interactive mode to root Improved skills Identifying decoy services distccd exploitation SUID binary privilege escalation GTFOBins usage for privilege escalation Used tools [[Nmap]] LinPEAS Python POC for distccd RCE Information Gathering Scanned all TCP ports:">
  <meta itemprop="wordCount" content="468">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Distccd,Samba,Nmap-Privesc">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Dragos Nutu">
  <meta name="twitter:description" content="Resolution summary [!summary]
Enumerated with [[Nmap]] finding FTP, SSH, SMB, and distccd services vsftpd 2.3.4 on port 21 appeared vulnerable but was a decoy (port 6200 filtered) SMB anonymous login successful but no useful access Exploited distccd v1 on port 3632 (CVE-2004-2687) for initial shell as daemon Enumerated with LinPEAS finding SUID binaries Escalated privileges using nmap interactive mode to root Improved skills Identifying decoy services distccd exploitation SUID binary privilege escalation GTFOBins usage for privilege escalation Used tools [[Nmap]] LinPEAS Python POC for distccd RCE Information Gathering Scanned all TCP ports:">



    <meta property="og:url" content="http://localhost:1313/writeups/lame/">
  <meta property="og:site_name" content="Dragos Nutu">
  <meta property="og:title" content="Dragos Nutu">
  <meta property="og:description" content="Resolution summary [!summary]
Enumerated with [[Nmap]] finding FTP, SSH, SMB, and distccd services vsftpd 2.3.4 on port 21 appeared vulnerable but was a decoy (port 6200 filtered) SMB anonymous login successful but no useful access Exploited distccd v1 on port 3632 (CVE-2004-2687) for initial shell as daemon Enumerated with LinPEAS finding SUID binaries Escalated privileges using nmap interactive mode to root Improved skills Identifying decoy services distccd exploitation SUID binary privilege escalation GTFOBins usage for privilege escalation Used tools [[Nmap]] LinPEAS Python POC for distccd RCE Information Gathering Scanned all TCP ports:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:tag" content="Distccd">
    <meta property="article:tag" content="Samba">
    <meta property="article:tag" content="Nmap-Privesc">
    <meta property="og:image" content="http://localhost:1313/">

















    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="../../" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                whoami</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="../../projects">Projects</a></li><li><a href="../../resume">Resume</a></li><li><a href="../../reviews">Reviews</a></li><li><a href="../../writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/lame/"></a></h2>

            
            
            

            <div class="post-content">
                <h1 id="resolution-summary">Resolution summary</h1>
<blockquote>
<p>[!summary]</p>
<ul>
<li>Enumerated with [[Nmap]] finding FTP, SSH, SMB, and distccd services</li>
<li>vsftpd 2.3.4 on port 21 appeared vulnerable but was a decoy (port 6200 filtered)</li>
<li>SMB anonymous login successful but no useful access</li>
<li>Exploited distccd v1 on port 3632 (CVE-2004-2687) for initial shell as daemon</li>
<li>Enumerated with LinPEAS finding SUID binaries</li>
<li>Escalated privileges using nmap interactive mode to root</li>
</ul>
</blockquote>
<h2 id="improved-skills">Improved skills</h2>
<ul>
<li>Identifying decoy services</li>
<li>distccd exploitation</li>
<li>SUID binary privilege escalation</li>
<li>GTFOBins usage for privilege escalation</li>
</ul>
<h2 id="used-tools">Used tools</h2>
<ul>
<li>[[Nmap]]</li>
<li>LinPEAS</li>
<li>Python POC for distccd RCE</li>
</ul>
<hr>
<h1 id="information-gathering">Information Gathering</h1>
<p>Scanned all TCP ports:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap 10.10.10.3 -sV -sC -p- -oA nmap_scans/10.10.10.3-sV-sC-p-
</span></span></code></pre></div><p>Enumerated open TCP ports:</p>
<pre tabindex="0"><code class="language-nmap" data-lang="nmap">Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 05:31 EDT
Nmap scan report for 10.10.10.3
Host is up (0.054s latency).
Not shown: 65530 filtered tcp ports (no-response)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to 10.10.16.2
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey:
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery:
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name:
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2025-07-27T05:33:45-04:00
|_clock-skew: mean: 2h00m21s, deviation: 2h49m46s, median: 18s
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)
</code></pre><hr>
<h1 id="enumeration">Enumeration</h1>
<h2 id="port-21---ftp-vsftpd-234">Port 21 - FTP (vsftpd 2.3.4)</h2>
<ul>
<li>vsftpd 2.3.4 identified - vulnerable to CVE-2011-2512 (backdoor)</li>
<li>Attempted multiple POCs but port 6200 is filtered (required for exploit)</li>
<li>Concluded vsftpd is likely a decoy</li>
</ul>
<h2 id="port-139445---smb-samba-3020-debian">Port 139/445 - SMB (Samba 3.0.20-Debian)</h2>
<ul>
<li>Anonymous login successful</li>
<li>Several files and folders discovered but no access granted</li>
<li>SMB also appears to be a decoy</li>
</ul>
<h2 id="port-3632---distccd">Port 3632 - distccd</h2>
<ul>
<li>distccd v1 running</li>
<li>Vulnerable to CVE-2004-2687 (Remote Code Execution)</li>
<li>Successfully exploited for initial access</li>
</ul>
<hr>
<h1 id="exploitation">Exploitation</h1>
<h2 id="distccd-remote-code-execution-cve-2004-2687">distccd Remote Code Execution (CVE-2004-2687)</h2>
<p>Used Python POC from:
<a href="https://gist.githubusercontent.com/adityatelange/3c067c7a126b93d2eaba195b65308577/raw/38637521969efb5797fb8020ab8085c0dd3f22b4/distccd_rce_CVE-2004-2687.py">https://gist.githubusercontent.com/adityatelange/3c067c7a126b93d2eaba195b65308577/raw/38637521969efb5797fb8020ab8085c0dd3f22b4/distccd_rce_CVE-2004-2687.py</a></p>
<p>Successfully executed commands and obtained reverse shell as <code>daemon</code> user.</p>
<hr>
<h1 id="privilege-escalation-to-root">Privilege Escalation to root</h1>
<h2 id="local-enumeration">Local enumeration</h2>
<p>Ran LinPEAS enumeration script which identified:</p>
<ul>
<li>Multiple SUID binaries</li>
<li>nmap with SUID bit set</li>
<li>Older version of nmap with interactive mode</li>
</ul>
<h2 id="privilege-escalation-vector">Privilege Escalation vector</h2>
<p>Exploited nmap interactive mode to spawn root shell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --interactive
</span></span><span style="display:flex;"><span>!sh
</span></span></code></pre></div><p>Reference: <a href="https://gtfobins.github.io/gtfobins/nmap/">https://gtfobins.github.io/gtfobins/nmap/</a></p>
<hr>
<h1 id="trophy">Trophy</h1>
<blockquote>
<p>[!todo] <strong>User.txt</strong>
Obtained via daemon shell</p>
</blockquote>
<blockquote>
<p>[!todo] <strong>Root.txt</strong>
Obtained via nmap privilege escalation</p>
</blockquote>
<p><strong>/etc/shadow</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root:$1$...
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/distccd/">distccd</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/samba/">samba</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/nmap-privesc/">nmap-privesc</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            
            
            <span></span>
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="../../bundle.min.ad54ad97364f77ede35def9096b162bb1f0b3973aa50b080f5e82fa147f6882e2a7200d7535adbf9b51bebf939f1c1ca9bbe6be87530092aca720eac4a226fda.js" integrity="sha512-rVStlzZPd&#43;3jXe&#43;QlrFiux8LOXOqULCA9egvoUf2iC4qcgDXU1rb&#43;bUb6/k58cHKm75r6HUwCSrKcg6sSiJv2g=="></script>




    </body>
</html>
